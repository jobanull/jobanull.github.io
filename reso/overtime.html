<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aplikasi Overtime</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#06b6d4;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    body{margin:0;background:linear-gradient(180deg,#071029 0%, #081424 100%);color:#e6eef6;padding:28px}
    .app{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:18px;margin-bottom:18px}
    header h1{font-size:20px;margin:0}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6);margin-bottom:14px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type="number"], input[type="text"], select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit}
    .row{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .row-2{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .controls{display:flex;gap:10px;align-items:center}
    button{padding:10px 12px;border-radius:8px;border:0;cursor:pointer;background:var(--accent);color:#052023}
    .muted-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .toggle-group{display:flex;gap:6px}
    .toggle{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);cursor:pointer;background:transparent}
    .toggle.active{background:#0e7490;color:#051219}
    .result{display:flex;gap:12px;flex-wrap:wrap}
    .stat{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px;min-width:180px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;text-align:left;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:14px}
    th{color:var(--muted);font-weight:600}
    .small{font-size:13px;color:var(--muted)}
    footer{margin-top:10px;color:var(--muted);font-size:13px}
    @media(max-width:820px){.row{grid-template-columns:1fr}.row-2{grid-template-columns:1fr}.stat{min-width:100%}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Aplikasi Overtime</h1>
      <div class="small">Berdasarkan perhitungan: Upah/jam = Upah sebulan / 173</div>
    </header>

    <section class="card">
      <div class="row">
        <div>
          <label>Gaji pokok + tunjangan tetap (Rp)</label>
          <input id="salary" type="number" value="8000000" min="0" />
        </div>

        <div>
          <label>Jumlah jam lembur</label>
          <input id="hours" type="number" value="8" min="0" max="24" />
        </div>

        <div>
          <label>Mode</label>
          <div class="toggle-group" role="tablist">
            <button id="mode-active" class="toggle active" type="button">Aktif</button>
            <button id="mode-passive" class="toggle" type="button">Pasif</button>
          </div>
        </div>
      </div>

      <div style="margin-top:10px" class="row-2">
        <div>
          <label>Asumsi pasif (% dari tarif aktif)</label>
          <input id="passivePct" type="number" value="50" min="0" max="100" />
          <div class="small">Jika mode Pasif dipilih, tarif pasif = tarif aktif × (persentase/100).</div>
        </div>

        <div>
          <label>Jam pertama dihitung sebagai</label>
          <select id="firstHourMultiplier">
            <option value="1.5">1.5 × upah/jam (standar)</option>
            <option value="2">2 × upah/jam</option>
          </select>
          <div class="small">Kepmenaker: jam 1 = 1,5×; jam 2+ = 2×. Pilih jika perusahaan punya aturan berbeda.</div>
        </div>
      </div>

      <div style="margin-top:12px" class="controls">
        <button id="calc">Hitung</button>
        <button id="reset" class="muted-btn">Reset</button>
        <button id="export" class="muted-btn">Salin CSV</button>
      </div>
    </section>

    <section id="output" class="card">
      <div class="result">
        <div class="stat">
          <div class="small">Upah per bulan</div>
          <div id="outSalary" style="font-weight:700;font-size:18px">Rp 8.000.000</div>
        </div>
        <div class="stat">
          <div class="small">Upah per jam (1/173)</div>
          <div id="outPerHour" style="font-weight:700;font-size:18px">Rp 46.242</div>
        </div>
        <div class="stat">
          <div class="small">Tarif jam 1</div>
          <div id="outHour1" style="font-weight:700;font-size:18px">Rp 69.363</div>
        </div>
        <div class="stat">
          <div class="small">Tarif jam 2+</div>
          <div id="outHour2" style="font-weight:700;font-size:18px">Rp 92.484</div>
        </div>
        <div class="stat">
          <div class="small">Total lembur</div>
          <div id="outTotal" style="font-weight:700;font-size:18px">Rp 716.751</div>
        </div>
      </div>

      <div id="breakdownArea" style="margin-top:12px">
        <table id="breakdown">
          <thead>
            <tr><th>Jam</th><th>Tarif per jam</th><th>Keterangan</th></tr>
          </thead>
          <tbody>
            <!-- rows inserted here -->
          </tbody>
        </table>
      </div>

      <footer>
        <strong>Catatan:</strong> Perhitungan standar sesuai Kepmenaker: upah/jam = gaji sebulan/173; jam pertama lembur = 1,5×; jam ke-2 dst = 2×. Untuk mode pasif, tidak ada rumus baku di Depnaker — aplikasi ini memakai persentase yang bisa diatur (default 50%).
      </footer>
    </section>
  </div>

  <script>
    // Utility
    const fmt = (n)=> {
      const x = Math.round(n);
      return 'Rp ' + x.toLocaleString('id-ID');
    }

    const $ = id => document.getElementById(id);

    function compute() {
      const salary = Number($('salary').value) || 0;
      const hours = Math.max(0, Math.floor(Number($('hours').value) || 0));
      const modePassive = $('mode-passive').classList.contains('active');
      const passivePct = Math.max(0, Math.min(100, Number($('passivePct').value) || 50));
      const firstMult = Number($('firstHourMultiplier').value) || 1.5;

      const perHour = salary / 173;
      const activeHour1 = perHour * firstMult;
      const activeHour2 = perHour * 2;

      let total = 0;
      const rows = [];

      for (let h=1; h<=hours; h++){
        let rateActive = (h===1)? activeHour1 : activeHour2;
        let rate = rateActive;
        let note = 'Aktif';
        if (modePassive) {
          rate = rateActive * (passivePct/100);
          note = `Pasif (${passivePct}% dari aktif)`;
        }
        total += rate;
        rows.push({h, rate, note});
      }

      // Update UI
      $('outSalary').textContent = fmt(salary);
      $('outPerHour').textContent = fmt(perHour);
      $('outHour1').textContent = fmt(activeHour1);
      $('outHour2').textContent = fmt(activeHour2);
      $('outTotal').textContent = fmt(total);

      const tbody = document.querySelector('#breakdown tbody');
      tbody.innerHTML = '';
      if (rows.length===0){
        const tr = document.createElement('tr');
        tr.innerHTML = '<td colspan="3" class="small">Tidak ada jam lembur</td>';
        tbody.appendChild(tr);
      } else {
        rows.forEach(r=>{
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>Jam ${r.h}</td><td>${fmt(r.rate)}</td><td class="small">${r.note}</td>`;
          tbody.appendChild(tr);
        })
      }

      return {salary, perHour, activeHour1, activeHour2, total, rows};
    }

    // Mode toggles
    $('mode-active').addEventListener('click', ()=>{
      $('mode-active').classList.add('active');
      $('mode-passive').classList.remove('active');
    });
    $('mode-passive').addEventListener('click', ()=>{
      $('mode-passive').classList.add('active');
      $('mode-active').classList.remove('active');
    });

    $('calc').addEventListener('click', ()=>{
      compute();
    });

    $('reset').addEventListener('click', ()=>{
      $('salary').value = 8000000;
      $('hours').value = 8;
      $('passivePct').value = 50;
      $('firstHourMultiplier').value = 1.5;
      $('mode-active').classList.add('active');
      $('mode-passive').classList.remove('active');
      compute();
    });

    $('export').addEventListener('click', ()=>{
      const data = compute();
      const rows = data.rows.map(r=> `${r.h},${Math.round(r.rate)},"${r.note}"`).join('\n');
      const header = 'Jam,Rate,Rincian\n';
      const csv = header + rows + (rows? '\n' : '');
      navigator.clipboard.writeText(csv).then(()=>{
        alert('CSV disalin ke clipboard. Anda bisa menempelkan ke file spreadsheet.');
      }, ()=>{ alert('Gagal menyalin ke clipboard.'); });
    });

    // initial compute
    compute();
  </script>
</body>
</html>