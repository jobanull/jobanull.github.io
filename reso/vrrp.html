<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Virtual Router Redundancy Protocol (VRRP)</title>
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="note-container">

  <main class="note-main">
    <h2 class="note-title text-center">Virtual Router Redundancy Protocol (VRRP)</h2>
    <p class="note-paragraph">
      VRRP (<strong>Virtual Router Redundancy Protocol</strong>) adalah protokol yang digunakan untuk menyediakan
      ketersediaan gateway default secara otomatis. Dengan VRRP, beberapa router dapat bekerja sama untuk
      menyediakan satu IP gateway virtual, sehingga jika router utama gagal, router cadangan akan mengambil alih
      tanpa mengganggu konektivitas jaringan.
    </p>

    <h3 class="note-subtitle">Fungsi VRRP</h3>
    <ul class="note-list">
      <li><strong>Redundansi</strong> – Menjamin gateway tetap aktif meskipun salah satu router mati.</li>
      <li><strong>Failover Otomatis</strong> – Perpindahan ke router cadangan terjadi secara otomatis.</li>
      <li><strong>Reliabilitas</strong> – Meningkatkan ketersediaan layanan jaringan.</li>
    </ul>

    <h3 class="note-subtitle">Cara Kerja VRRP</h3>
    <p class="note-paragraph">
      VRRP bekerja dengan konsep satu <em>Master Router</em> dan satu atau lebih <em>Backup Router</em>.
      Semua router dalam grup berbagi satu <strong>Virtual IP Address</strong> yang digunakan klien sebagai
      gateway. Master Router akan mengirimkan iklan (advertisement) secara berkala. Jika iklan ini berhenti,
      Backup Router dengan prioritas tertinggi akan menjadi Master baru.
    </p>

    <h3 class="note-subtitle">Parameter Penting</h3>
    <ul class="note-list">
      <li><strong>Virtual IP</strong> – IP gateway yang digunakan oleh klien.</li>
      <li><strong>Priority</strong> – Menentukan urutan router yang akan menjadi Master.</li>
      <li><strong>Advertisement Interval</strong> – Waktu antar pengiriman iklan status dari Master.</li>
    </ul>

    <h3 class="note-subtitle">CONTOH KASUS</h3>
    <ul class="note-list">
        <li>Tujuan: Mengimplementasikan <strong>VRF (Virtual Routing and Forwarding)</strong> di MikroTik untuk memisahkan tabel routing 
            berdasarkan traffic yang masuk melalui interface tertentu.</li>
        <li>Topologi: 
            <ul>
                <li>Router R.VRF terhubung ke internet melalui <code>ether1</code>.</li>
                <li>Interface <code>ether2</code> dan <code>ether3</code> berada pada LAN yang sama <code>192.168.1.0/24</code>.</li>
                <li>Traffic dari <code>ether3</code> diarahkan menggunakan VRF dengan <code>routing-mark=vrf1</code>.</li>
            </ul>
        </li>
        <li>Catatan:
            <ul>
                <li>Menggunakan <strong>mangle rule</strong> untuk menandai koneksi dan routing.</li>
                <li>VRF digunakan agar trafik di <code>ether3</code> bisa diarahkan melalui tabel routing terpisah.</li>
                <li>Default NAT diterapkan di <code>ether1</code> untuk akses internet.</li>
            </ul>
        </li>
    </ul>


    <img src="img/vrrp.png" alt="Diagram jaringan" class="note-image" />
    
    <h3 class="note-subtitle">R.VRRP1</h3>
    <pre class="note-codeblock"><code>
/interface vrrp
add interface=ether2 name=vrrp1 priority=254 vrid=49          # VRRP di ether2, VRID = 49, priority tinggi (Master)

/ip pool
add name=dhcp_pool1 ranges=192.168.2.1-192.168.2.253          # Pool DHCP untuk LAN

/ip dhcp-server
add address-pool=dhcp_pool1 disabled=no interface=ether2 name=dhcp1

/ip address
add address=192.168.2.1/24 interface=ether2 network=192.168.2.0    # IP fisik router VRRP1
add address=192.168.2.254 interface=vrrp1 network=192.168.2.0      # Virtual IP (shared oleh VRRP)

/ip dhcp-client
add disabled=no interface=ether1                                   # DHCP client untuk WAN

/ip dhcp-server network
add address=192.168.2.0/24 gateway=192.168.2.254                   # Gateway DHCP = Virtual IP (192.168.2.254)

/ip firewall nat
add action=masquerade chain=srcnat out-interface=ether1            # NAT keluar ke WAN

/system identity
set name=R.VRRP1
    </code></pre>

    <h3 class="note-subtitle">R.VRRP2</h3>
    <pre class="note-codeblock"><code>
/interface vrrp
add interface=ether2 name=vrrp1 vrid=49                     # VRRP di ether2, VRID sama (49)

/ip pool
add name=dhcp_pool2 ranges=192.168.2.1-192.168.2.253        # Pool DHCP untuk LAN

/ip dhcp-server
add address-pool=dhcp_pool2 disabled=no interface=ether2 name=dhcp1

/ip address
add address=192.168.2.2/24 interface=ether2 network=192.168.2.0    # IP fisik router VRRP2
add address=192.168.2.254 interface=vrrp1 network=192.168.2.0      # Virtual IP sama (192.168.2.254)

/ip dhcp-client
add disabled=no interface=ether1                                 # DHCP client untuk WAN

/ip dhcp-server network
add address=192.168.2.0/24 gateway=192.168.2.254                 # Gateway DHCP tetap Virtual IP

/ip firewall nat
add action=masquerade chain=srcnat out-interface=ether1          # NAT keluar ke WAN

/system identity
set name=R.VRRP2
    </code></pre>

    <h3 class="note-subtitle">Kelebihan VRRP</h3>
    <ul class="note-list">
      <li>Proses failover cepat dan otomatis.</li>
      <li>Meminimalkan downtime jaringan.</li>
      <li>Bekerja lintas vendor (open standard).</li>
    </ul>

    <h3 class="note-subtitle">Ringkasan</h3>
    <p class="note-paragraph">
      VRRP adalah solusi efektif untuk menjaga ketersediaan gateway jaringan. Dengan konfigurasi yang tepat,
      VRRP memastikan konektivitas pengguna tetap stabil meskipun terjadi kegagalan pada router utama.
    </p>

    <hr class="note-divider" />
  </main>

  <script>
    document.querySelectorAll('.note-image').forEach(img => {
      img.addEventListener('click', () => img.classList.toggle('expanded'));
    });
  </script>
</body>
</html>
