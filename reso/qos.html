<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>QoS (Simple-Q, Queue Tree, Burst-Q, Layer 7-Q, PCQ)</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="note-container">

  <main class="note-main">
    <h2 class="note-title">QoS (Simple Queue, Queue Tree, Burst Queue, Layer 7 Queue, PCQ)</h2>
    <p class="note-paragraph">
      Quality of Service (QoS) mengatur prioritas dan pembagian bandwidth agar trafik penting mendapatkan kualitas yang sesuai.
      Di MikroTik, terdapat beberapa metode: <strong>Simple Queue</strong>, <strong>Queue Tree</strong>, <strong>Burst Queue</strong>, 
      <strong>Layer 7 Queue</strong>, dan <strong>PCQ</strong>. 
    </p>

    <!-- Simple Queue -->
    <h3 class="note-subtitle">1. Simple Queue</h3>
    <p class="note-paragraph">
      Paling mudah dipakai, cocok untuk membatasi atau menjamin bandwidth per IP atau subnet.
      Dapat menggunakan <em>Target Upload/Download</em> dan mendukung <strong>HTB</strong> untuk prioritas.
    </p>
    <ul class="note-list">
      <li><strong>Kelebihan:</strong> Setup cepat, GUI-friendly.</li>
      <li><strong>Kekurangan:</strong> Tidak optimal untuk trafik kompleks atau banyak class.</li>
      <li><strong>Gunakan Saat:</strong> Membatasi bandwidth user individu.</li>
    </ul>
        <h3 class="note-subtitle">CONTOH KASUS</h3>
    <ul class="note-list">
        <li>Topologi menggunakan protokol routing <b>OSPF</b> pada tujuh router MikroTik (RB1-RB7).</li>
    </ul>


    <img src="img/qos.png" alt="Diagram jaringan" class="note-image" />
    <h3 class="note-subtitle">R.SQ</h3>
    <pre class="note-codeblock"><code>
/ip pool
add name=dhcp_pool0 ranges=192.168.1.2
add name=dhcp_pool1 ranges=192.168.2.2
/ip dhcp-server
add address-pool=dhcp_pool0 disabled=no interface=ether2 name=dhcp1
add address-pool=dhcp_pool1 disabled=no interface=ether3 name=dhcp2
/queue simple
add max-limit=1M/1M name=queue-parent target=192.168.1.0/30
add max-limit=254k/254k name=child-queue1 parent=queue-parent target=\
    192.168.1.2/32
add max-limit=1M/1M name=queue-ether3 target=192.168.2.2/32
/ip address
add address=192.168.1.1/30 interface=ether2 network=192.168.1.0
add address=192.168.2.1/30 interface=ether3 network=192.168.2.0
/ip dhcp-client
add disabled=no interface=ether1
/ip dhcp-server network
add address=192.168.1.0/30 gateway=192.168.1.1
add address=192.168.2.0/30 gateway=192.168.2.1
/ip firewall nat
add action=masquerade chain=srcnat out-interface=ether1
/system identity
set name=R.SQ
    </code></pre>

    <!-- Queue Tree -->
    <h3 class="note-subtitle">2. Queue Tree</h3>
    <p class="note-paragraph">
      Digunakan untuk membuat <strong>hierarchical queues</strong> di sebuah interface. Cocok untuk pembagian bandwidth
      berdasarkan kategori trafik atau prioritas.
    </p>
    <ul class="note-list">
      <li><strong>Kelebihan:</strong> Sangat fleksibel, cocok untuk QoS kompleks.</li>
      <li><strong>Kekurangan:</strong> Konfigurasi lebih rumit; perlu mangle untuk menandai paket.</li>
      <li><strong>Gunakan Saat:</strong> ISP atau jaringan besar yang butuh pembagian bandwidth detail.</li>
    </ul>
        <h3 class="note-subtitle">CONTOH KASUS</h3>
    <ul class="note-list">
        <li>Topologi menggunakan protokol routing <b>OSPF</b> pada tujuh router MikroTik (RB1-RB7).</li>
    </ul>


    <img src="img/qos.png" alt="Diagram jaringan" class="note-image" />
    <h3 class="note-subtitle">R.QT</h3>
    <pre class="note-codeblock"><code>
/ip pool
add name=dhcp_pool0 ranges=192.168.1.2
add name=dhcp_pool1 ranges=192.168.2.2
/ip dhcp-server
add address-pool=dhcp_pool0 disabled=no interface=ether2 name=dhcp1
add address-pool=dhcp_pool1 disabled=no interface=ether3 name=dhcp2
/queue tree
add max-limit=1M name=queue-parent-upload parent=ether1
add max-limit=254k name=queue1-upload packet-mark=packet-client1 parent=\
    queue-parent-upload
add max-limit=254k name=queue2-upload packet-mark=packet-client2 parent=\
    queue-parent-upload
/ip address
add address=192.168.1.1/30 interface=ether2 network=192.168.1.0
add address=192.168.2.1/30 interface=ether3 network=192.168.2.0
/ip dhcp-client
add disabled=no interface=ether1
/ip dhcp-server network
add address=192.168.1.0/30 gateway=192.168.1.1
add address=192.168.2.0/30 gateway=192.168.2.1
/ip firewall mangle
add action=mark-connection chain=prerouting new-connection-mark=\
    conn-client1 passthrough=yes src-address=192.168.1.2
add action=mark-connection chain=prerouting new-connection-mark=\
    conn-client2 passthrough=yes src-address=192.168.2.2
add action=mark-packet chain=prerouting connection-mark=conn-client1 \
    new-packet-mark=packet-client1 passthrough=no
add action=mark-packet chain=prerouting connection-mark=conn-client2 \
    new-packet-mark=packet-client2 passthrough=no
/ip firewall nat
add action=masquerade chain=srcnat out-interface=ether1
/system identity
set name=R.QT
    </code></pre>

    <!-- Burst Queue -->
    <h3 class="note-subtitle">3. Burst Queue</h3>
    <p class="note-paragraph">
      Memungkinkan user mendapatkan bandwidth lebih besar sementara (<em>burst</em>) jika rata-rata penggunaan masih di bawah 
      <strong>burst-threshold</strong>.
    </p>
    <ul class="note-list">
      <li><strong>Kelebihan:</strong> Memberi pengalaman “cepat” saat awal download.</li>
      <li><strong>Kekurangan:</strong> Tidak menjaga kecepatan burst terus-menerus.</li>
      <li><strong>Gunakan Saat:</strong> ISP rumahan atau kantor yang ingin respons awal cepat.</li>
    </ul>
    <pre class="note-codeblock"><code>
# 1M normal, burst sampai 2M selama 10 detik
/queue simple
add target=192.168.1.20/32 max-limit=1M/1M \
    burst-limit=2M/2M burst-threshold=800k/800k burst-time=10s
    </code></pre>

    <!-- Layer 7 Queue -->
    <h3 class="note-subtitle">4. Layer 7 Queue</h3>
    <p class="note-paragraph">
      Menggunakan <em>Layer 7 protocol matcher</em> untuk mendeteksi trafik berdasarkan pola di payload (regex).
      Cocok untuk memfilter atau memprioritaskan aplikasi/protokol tertentu.
    </p>
    <ul class="note-list">
      <li><strong>Kelebihan:</strong> Bisa mengenali trafik spesifik (YouTube, Facebook, dll.).</li>
      <li><strong>Kekurangan:</strong> CPU-heavy, tidak efektif untuk trafik terenkripsi (HTTPS).</li>
      <li><strong>Gunakan Saat:</strong> Trafik masih plaintext atau protokol khusus.</li>
    </ul>
    <pre class="note-codeblock"><code>
# Match YouTube
/ip firewall layer7-protocol
add name=yt regex="^.+(youtube.com|ytimg.com).*\$"

/ip firewall mangle
add chain=prerouting layer7-protocol=yt action=mark-packet new-packet-mark=yt

# Queue untuk YouTube
/queue tree
add name="youtube" parent=ether1 packet-mark=yt max-limit=3M
    </code></pre>

    <!-- PCQ -->
    <h3 class="note-subtitle">5. PCQ (Per Connection Queue)</h3>
    <p class="note-paragraph">
      Queue type yang otomatis membagi bandwidth secara adil ke setiap koneksi/host. Sering dipakai ISP
      untuk membagi bandwidth ke banyak user tanpa membuat queue satu-satu.
    </p>
    <ul class="note-list">
      <li><strong>Kelebihan:</strong> Fair bandwidth sharing otomatis.</li>
      <li><strong>Kekurangan:</strong> Tidak bisa memprioritaskan user tertentu.</li>
      <li><strong>Gunakan Saat:</strong> ISP hotspot, warnet, kampus.</li>
    </ul>

    <h3 class="note-subtitle">CONTOH KASUS</h3>
    <ul class="note-list">
        <li>Topologi menggunakan protokol routing <b>OSPF</b> pada tujuh router MikroTik (RB1-RB7).</li>
    </ul>


    <img src="img/qos.png" alt="Diagram jaringan" class="note-image" />
    <h3 class="note-subtitle">R.PCQ</h3>
    <pre class="note-codeblock"><code>
/ip pool
add name=dhcp_pool0 ranges=192.168.1.2-192.168.1.6
/ip dhcp-server
add address-pool=dhcp_pool0 disabled=no interface=LAN name=dhcp1
/queue type
add kind=pcq name=pcq-download pcq-rate=254k
add kind=pcq name=pcq-upload pcq-rate=254k
/queue simple
add max-limit=1M/1M name=PCQ_Client queue=pcq-upload/pcq-upload target=\
    192.168.1.0/29
/interface bridge port
add bridge=LAN interface=ether2
add bridge=LAN interface=ether3
/ip address
add address=192.168.1.1/29 interface=LAN network=192.168.1.0
/ip dhcp-client
add disabled=no interface=ether1
/ip dhcp-server network
add address=192.168.1.0/29 gateway=192.168.1.1
/ip firewall nat
add action=masquerade chain=srcnat out-interface=ether1
/system identity
set name=R.PCQ
    </code></pre>

    <!-- Tips -->
    <h3 class="note-subtitle">Tips Praktis</h3>
    <ul class="note-list">
      <li>Gunakan <strong>HTB</strong> di Simple Queue untuk hierarki sederhana.</li>
      <li>Queue Tree wajib punya parent interface/global, bukan target IP langsung.</li>
      <li>Layer 7 sebaiknya dipakai untuk pola ringan dan non-HTTPS.</li>
      <li>PCQ cocok untuk membagi rata bandwidth ke banyak client otomatis.</li>
      <li>Burst memberi user kesan “cepat” tapi tetap menjaga rata-rata bandwidth.</li>
    </ul>

    <h3 class="note-subtitle">Ringkasan</h3>
    <p class="note-paragraph">
      <strong>Simple Queue</strong> untuk konfigurasi cepat per user, <strong>Queue Tree</strong> untuk QoS kompleks,
      <strong>Burst</strong> untuk percepatan sementara, <strong>Layer 7</strong> untuk deteksi aplikasi,
      dan <strong>PCQ</strong> untuk pembagian bandwidth adil otomatis.
    </p>

    <hr class="note-divider" />
  </main>

</body>
</html>
