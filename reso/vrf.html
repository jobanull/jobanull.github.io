<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Virtual Routing and Forwarding (VRF)</title>
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="note-container">

  <main class="note-main">
    <h2 class="note-title text-center">Virtual Routing and Forwarding (VRF)</h2>
    <p class="note-paragraph">
      VRF (<strong>Virtual Routing and Forwarding</strong>) adalah teknologi pada perangkat jaringan
      yang memungkinkan satu router atau switch layer 3 memiliki beberapa tabel routing yang terpisah secara logis.
      Dengan VRF, lalu lintas dari setiap tabel routing tetap terisolasi, sehingga beberapa jaringan dapat menggunakan
      alamat IP yang sama tanpa saling mengganggu.
    </p>

    <h3 class="note-subtitle">Fungsi dan Tujuan VRF</h3>
    <ul class="note-list">
      <li><strong>Isolasi lalu lintas</strong> – Memisahkan routing antar pelanggan atau departemen.</li>
      <li><strong>Dukungan Multi-Tenant</strong> – Cocok untuk ISP atau data center yang melayani banyak klien.</li>
      <li><strong>Keamanan</strong> – Mencegah pertukaran paket antar VRF yang berbeda.</li>
      <li><strong>Efisiensi</strong> – Menghemat perangkat dengan memanfaatkan satu hardware untuk banyak jaringan logis.</li>
    </ul>

    <h3 class="note-subtitle">Jenis VRF</h3>
    <ul class="note-list">
      <li><strong>VRF Lite</strong> – Implementasi VRF tanpa MPLS, biasanya digunakan di enterprise.</li>
      <li><strong>MPLS VRF</strong> – VRF yang digunakan bersama MPLS untuk membangun VPN antar lokasi.</li>
    </ul>

    <h3 class="note-subtitle">Kelebihan VRF</h3>
    <ul class="note-list">
      <li>Memungkinkan penggunaan alamat IP overlapped di jaringan berbeda.</li>
      <li>Meningkatkan keamanan dan segmentasi jaringan.</li>
      <li>Mengurangi kebutuhan perangkat fisik terpisah.</li>
    </ul>

    <h3 class="note-subtitle">CONTOH KASUS</h3>
    <ul class="note-list">
        <li>Topologi menggunakan protokol routing <b>OSPF</b> pada tujuh router MikroTik (RB1-RB7).</li>
    </ul>


    <img src="img/vrf.png" alt="Diagram jaringan" class="note-image" />
    <h3 class="note-subtitle">R.VRF</h3>
    <pre class="note-codeblock"><code>
/ip address
add address=192.168.1.1/24 interface=ether2 network=192.168.1.0     # IP LAN1 (ether2)
add address=192.168.1.1/24 interface=ether3 network=192.168.1.0     # IP LAN2 (ether3)

/ip dhcp-client
add disabled=no interface=ether1                                    # DHCP client untuk WAN (ether1)

/ip firewall mangle
add action=mark-connection chain=prerouting in-interface=ether3 \
    new-connection-mark=con-vrf passthrough=yes                     # Tandai koneksi dari ether3
add action=mark-routing chain=prerouting connection-mark=con-vrf \
    in-interface=ether1 new-routing-mark=vrf1 passthrough=yes       # Tandai routing untuk traffic ether3 → WAN
add action=mark-routing chain=output connection-mark=con-vrf \
    disabled=yes new-routing-mark=vrf1 passthrough=yes              # (Opsional) mark routing untuk traffic output

/ip firewall nat
add action=masquerade chain=srcnat out-interface=ether1             # NAT untuk keluar lewat WAN

/ip route
add distance=1 gateway=192.168.209.1@main routing-mark=vrf1         # Default route VRF1 lewat gateway WAN

/ip route vrf
add interfaces=ether3 routing-mark=vrf1                             # Buat VRF khusus untuk interface ether3

/system identity
set name=R.VRF                                                      # Nama router
    </code></pre>

    <h3 class="note-subtitle">Ringkasan</h3>
    <p class="note-paragraph">
      VRF memungkinkan satu perangkat jaringan mengelola beberapa jaringan logis yang terisolasi.
      Teknologi ini sangat bermanfaat untuk ISP, data center, dan perusahaan besar yang memerlukan segmentasi
      dan keamanan tinggi tanpa menambah perangkat fisik.
    </p>

    <hr class="note-divider" />
  </main>

  <script>
    document.querySelectorAll('.note-image').forEach(img => {
      img.addEventListener('click', () => img.classList.toggle('expanded'));
    });
  </script>
</body>
</html>
